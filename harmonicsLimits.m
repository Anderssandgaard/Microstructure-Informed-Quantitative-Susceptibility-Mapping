function bp = harmonicsLimits(lmax)
% bp = sqrt(4*pi)*[0.6308 0.3863 0.3863 0.3863 0.3863 ...
%                  0.8463 0.4996 0.4301 0.4065 0.4425 0.4996 0.4301 0.4065 0.4425 ...
%                  1.0171 0.5959 0.5046 0.4597 0.4368 0.4331 0.4831 0.5959 0.5046 0.4597 0.4368 0.4331 0.4831 ...
%                  1.1631 0.6794 0.5723 0.5164 0.4825 0.4617 0.4519 0.4568 0.5154 0.6794 0.5723 0.5164 0.4825 0.4617 0.4519 0.4568 0.5154 ...
%                  1.2927 0.7541 0.6334 0.5694 0.5287 0.5011 0.4823 0.4709 0.4675 0.4776 0.5426 0.7541 0.6334 0.5694 0.5287 0.5011 0.4823 0.4709 0.4675 0.4776 0.5426 ...
%                  1.4105 0.8222 0.6897 0.6187 0.5728 0.5405 0.5170 0.4999 0.4882 0.4819 0.4826 0.4962 0.5663 0.8222 0.6897 0.6187 0.5728 0.5405 0.5170 0.4999 0.4882 0.4819 0.4826 0.4962 0.5663];
% bp = bp(1:(lmax+3)*lmax/2);

persistent lmax0 BP
if isempty(BP) || lmax>lmax0
    lmax0 = lmax;
    
    BP = zeros(1,(lmax+3)*lmax/2);
    x = linspace(0,1,1e4)';
    i = 0;
    for l = 2:2:lmax
        m = [0 1:l]';
        BP(i+1:i+1+l) = sqrt((2*l+1)*factorial(l-m)./factorial(l+m)).*max(abs(legendre(l,x)),[],2);
        BP(i+2+l:i+1+2*l) = BP(i+2:i+1+l);
        i = i+1+2*l;
    end
end

bp = BP(1:(lmax+3)*lmax/2);